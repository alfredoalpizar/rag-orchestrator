server:
  port: 8080
  error:
    include-message: always
    include-binding-errors: always

spring:
  application:
    name: rag-orchestrator
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false

  # Database Configuration (Sybase ASE)
  # Note: Comment out datasource config when using in-memory conversation mode
  # datasource:
  #   url: ${DB_URL:jdbc:sybase:Tds:localhost:5000/your_database}
  #   username: ${DB_USERNAME:}
  #   password: ${DB_PASSWORD:}
  #   driver-class-name: com.sybase.jdbc4.jdbc.SybDriver

  # jpa:
  #   hibernate:
  #     ddl-auto: validate  # Use flyway for migrations
  #   properties:
  #     hibernate:
  #       dialect: org.hibernate.dialect.SybaseASE15Dialect
  #       format_sql: true
  #   show-sql: false

# DeepSeek API Configuration
deepseek:
  api:
    base-url: ${DEEPSEEK_BASE_URL:https://api.deepseek.com}
    api-key: ${DEEPSEEK_API_KEY:}
    chat-model: ${DEEPSEEK_CHAT_MODEL:deepseek-chat}
    reasoning-model: ${DEEPSEEK_REASONING_MODEL:deepseek-reasoner}
    embedding-model: ${DEEPSEEK_EMBEDDING_MODEL:deepseek-embedding-v2}
    timeout-seconds: 60
    max-retries: 3

# ChromaDB Configuration
chromadb:
  base-url: ${CHROMADB_BASE_URL:http://localhost:8000}
  collection-name: ${CHROMADB_COLLECTION:knowledge_base}
  max-results: 5
  timeout-seconds: 30

# Loop Configuration
loop:
  max-iterations: 10
  max-tokens: 4096
  temperature: 0.7
  use-reasoning-model: false  # Set true to use deepseek-reasoner

  # Streaming Configuration
  streaming:
    mode: status_only  # Options: status_only | full_reasoning
    show-tool-calls: true
    show-rag-queries: true
    buffer-size: 256

# Conversation Management
conversation:
  storage-mode: in-memory  # Options: in-memory | sql | redis (use in-memory for quick start)
  max-context-tokens: 100000
  compression-threshold: 80000
  rolling-window-size: 20  # Keep last N messages
  ttl-hours: 720  # 30 days before archival
  cleanup-interval-minutes: 60
  archive:
    enabled: false  # Enable S3 archival later
    s3-bucket: ${ARCHIVE_S3_BUCKET:}
    archive-after-days: 90

# Logging
logging:
  level:
    root: INFO
    com.alfredoalpizar.rag: DEBUG
    org.springframework.web: INFO
    org.springframework.web.reactive.function.client: DEBUG
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql.BasicBinder: INFO

# Actuator Endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,flyway
  endpoint:
    health:
      show-details: always