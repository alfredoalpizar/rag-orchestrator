# ============================================
# Spring Boot Framework Configuration
# ============================================
# All application-specific config moved to Environment.kt
# Configure via environment variables (12-factor app pattern)

server:
  port: 8080
  error:
    include-message: always
    include-binding-errors: always

spring:
  application:
    name: rag-orchestrator
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false

  # Disable database auto-configuration for in-memory mode (default)
  # Remove these exclusions when using CONVERSATION_STORAGE_MODE=database
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
      - org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration
      - org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration

  # Database Configuration (PostgreSQL)
  # Uncomment when using CONVERSATION_STORAGE_MODE=database (and remove autoconfigure.exclude above)
  # datasource:
  #   url: ${DB_URL:jdbc:postgresql://localhost:5432/rag_orchestrator}
  #   username: ${DB_USERNAME:postgres}
  #   password: ${DB_PASSWORD:}
  #   driver-class-name: org.postgresql.Driver

  # jpa:
  #   hibernate:
  #     ddl-auto: validate  # Use flyway for migrations
  #   properties:
  #     hibernate:
  #       dialect: org.hibernate.dialect.PostgreSQLDialect
  #       format_sql: true
  #   show-sql: false

# Logging
logging:
  level:
    root: INFO
    com.alfredoalpizar.rag: DEBUG
    org.springframework.web: INFO
    org.springframework.web.reactive.function.client: DEBUG
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql.BasicBinder: INFO

# Actuator Endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

# ============================================
# Application Configuration via Environment Variables
# ============================================
# All app config is now in Environment.kt and configured via environment variables.
# See Environment.kt for full list of available configuration options.
#
# Examples:
# - FIREWORKS_API_KEY=your_key
# - QWEN_THINKING_MODEL=accounts/fireworks/models/qwen3-235b-a22b-instruct-2507
# - DEEPSEEK_API_KEY=your_key
# - CHROMADB_BASE_URL=http://localhost:8000
# - LOOP_MAX_ITERATIONS=10
# - CONVERSATION_STORAGE_MODE=in-memory
